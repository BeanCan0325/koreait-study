SELECT * FROM employees
ORDER BY birth_date desc;
-- 오름차순/ 뒤에 desc: 내림차순// ASC:올림차순(기본값)

SELECT * FROM titles 
order BY to_date DESC;


-- 함수
SELECT max(salary) FROM salaries;
SELECT salary from salaries;
SELECT min(salary) from salaries;
SELECT avg(salary) from salaries;
SELECT sum(salary) from salaries;

-- 조회된 칼럼의 개수
SELECT count(salary) from salaries; 
SELECT count(*) AS '직원수' from salaries; 

-- title 이 엔지니어인 직원의 수
SELECT count(title) from titles
WHERE title = 'Enginner';

-- 입사일이 1965년 1월1일 이후인 직원의 수 조회
SELECT count(*) FROM employees
WHERE hire_date > '1965-01-01';

-- emp_no가 가장 낮은 직원과 가장 높은 직원 조회
SELECT * FROM employees
WHERE emp_no = (SELECT min(emp_no) FROM employees)
OR emp_no = (SELECT Max(emp_no) FROM employees);

SELECT min(emp_no), max(emp_no) FROM employees;

-- 에러 "행의 개수가 안맞음"
-- SELECT max(emp_no), birth_date FROM employees;


-- [group by]
-- 조회된 데이터 여러 개의 행을 특정 컬럼을 기준으로 묶어 
SELECT max(emp_no), birth_date FROM employees
GROUP BY birth_date;
-- group by(1.먼저 같은 값들끼리 그룹화)를 기준으로 emp_No가 높은 수를 가져오는거 
SELECT count(*), birth_date FROM employees
GROUP BY birth_date;


-- 부서별 직원 수 구하기
-- 직원수, 부서 번호(dept_no) 조회

SELECT count(*), dept_no FROM dept_emp
GROUP BY dept_no;

-- 실습 문제 
-- q1
SELECT count(*) FROM  employees
GROUP by(gender);


-- q2
SELECT count(*), title FROM titles
GROUP BY (title)
order BY title DESC;

SELECT count(*), title FROM titles
GROUP BY (title)
-- group by 아래에 조건주기 "Having"
HAVING count(*) >= 100000;
order BY title DESC;

-- 조건을 줄때 그룹 함 수 필요 
-- Having : 그룹함수 필요시 / Where: 그룹함수 필요 없을 시 

-- dept_emp에서 직원 수가 5만 이상인 부서만 조회
SELECT count(*),FROM dept_emp
GROUP BY dept_no 
HAVING count(*) >= 50000;

-- 현재 재직중 직원들 중 직무별 직원 수가 200명 미만인 직무만 조회
SELECT count(*),title FROM titles
WHERE to_date = '9999-01-01'
GROUP BY title 
HAVING count(*) < 200;


-- [select 쿼리 실행 순서] 
-- from -> where -> Group by -> having -> select -> ordered by 
SELECT count(*),title FROM titles
WHERE to_date = '9999-01-01'
GROUP BY title 
HAVING count(*) < 200;
Ordered BY    -- 가장 마지막으로 실행

-- 

SELECT * count 